From e88a776a7bf5c7708ed0b67c92025e60d12824f1 Mon Sep 17 00:00:00 2001
From: Mike Banon <mikebdp2@gmail.com>
Date: Fri, 29 Nov 2019 17:50:26 +0000
Subject: [PATCH] Modify ./drivers/Makefile according to WR841N(D)v9 u-boot

---
 drivers/pci/Makefile | 4 ++++
 drivers/rtc/Makefile | 24 ++++++++++++++++++++++++
 2 files changed, 28 insertions(+)

diff --git a/drivers/pci/Makefile b/drivers/pci/Makefile
index fe45839466..70224dfbfb 100644
--- a/drivers/pci/Makefile
+++ b/drivers/pci/Makefile
@@ -25,12 +25,16 @@ include $(TOPDIR)/config.mk
 
 LIB 	:= $(obj)libpci.a
 
+ifeq ($(COMPRESSED_UBOOT),1) # cu570m condition branch
+COBJS-y += pci.o
+else # old default path
 COBJS-y += fsl_pci_init.o
 COBJS-y += pci.o
 COBJS-y += pci_auto.o
 COBJS-y += pci_indirect.o
 COBJS-y += tsi108_pci.o
 COBJS-y += w83c553f.o
+endif # cu570m
 
 COBJS	:= $(COBJS-y)
 SRCS 	:= $(COBJS:.o=.c)
diff --git a/drivers/rtc/Makefile b/drivers/rtc/Makefile
index 2af2bf4a51..8b717c461f 100644
--- a/drivers/rtc/Makefile
+++ b/drivers/rtc/Makefile
@@ -27,6 +27,29 @@ include $(TOPDIR)/config.mk
 
 LIB	= $(obj)librtc.a
 
+ifeq ($(COMPRESSED_UBOOT),1) # cu570m condition branch
+COBJS-y += date.o
+COBJS-y += bfin_rtc.o
+COBJS-y += ds12887.o
+COBJS-y += ds1302.o
+COBJS-y += ds1306.o
+COBJS-y += ds1307.o
+COBJS-y += ds1337.o
+COBJS-y += ds1374.o
+COBJS-y += ds1556.o
+COBJS-y += ds164x.o
+COBJS-y += ds174x.o
+COBJS-y += m41t11.o
+COBJS-y += m48t35ax.o
+COBJS-y += max6900.o
+COBJS-y += mc146818.o
+COBJS-y += mk48t59.o
+COBJS-y += mpc5xxx.o
+COBJS-y += mpc8xx.o
+COBJS-y += pcf8563.o
+COBJS-y += rs5c372.o
+COBJS-y += s3c24x0_rtc.o
+else # old default path
 COBJS-y += date.o
 COBJS-y += bfin_rtc.o
 COBJS-y += ds12887.o
@@ -53,6 +76,7 @@ COBJS-y += rs5c372.o
 COBJS-y += rx8025.o
 COBJS-y += mcfrtc.o
 COBJS-y += x1205.o
+endif # cu570m
 
 COBJS	:= $(COBJS-y)
 SRCS	:= $(COBJS:.o=.c)
-- 
2.24.0

